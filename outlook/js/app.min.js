"use strict";var OFI_2018_OUTLOOK=OFI_2018_OUTLOOK||{};!function(){OFI_2018_OUTLOOK.namespace=function(t){var e,n=t.split("."),a=OFI_2018_OUTLOOK;for("OFI_2018_OUTLOOK"===n[0]&&(n=n.slice(1)),e=0;e<n.length;e+=1)void 0===a[n[e]]&&(a[n[e]]={}),a=a[n[e]];return a}}(),OFI_2018_OUTLOOK.namespace("app"),OFI_2018_OUTLOOK.app=function(t){var e,n,a,i,r,o,s,l,d,u,c,h,p,f,_,g,v,m,y,b=!1,$=!1,x=function(){C(),_=window.top.location,g=window.top.location.protocol+"//"+window.top.location.hostname+(window.top.location.port?":"+window.top.location.port:"")+"/",v=window.top.location.pathname.split("/")[1],m="","ofi-web"==v&&($=!0),y=B.get_query_value("section",_),a.addClass("noResize"),a.addClass("noTouch"),i.addClass(v),w.init(),T.init(),A.init(),k.init(),O.init(),S.init(),q.init(),D.init(),M.init(),!1!==w.is_IE()&&a.addClass("ie"),setTimeout(function(){if(b=!0,y){var t=k.region_name.indexOf(y);O.$cont.addClass("skip-animation"),t>-1&&(2!==k.id?T.height>580?(k.$regional_nav_sect.addClass("quick-open"),setTimeout(function(){k.anchor_anim(2)},500),setTimeout(function(){q.open_region(t)},1700)):(q.id=t,q.expand(t),setTimeout(function(){k.anchor_anim(2)},250),i.addClass("no-scroll"),h.addClass("on"),h.attr("data-active-region",t),h.css("transition-delay","0s"),p.scrollTop(0)):T.height>580?(k.$regional_nav_sect.addClass("quick-open"),setTimeout(function(){q.open_region(t)},500)):(q.id=t,q.expand(t),setTimeout(function(){k.anchor_anim(2)},250),i.addClass("no-scroll"),h.addClass("on"),h.attr("data-active-region",t),h.css("transition-delay","0s"),p.scrollTop(0))),"global-heatmap"==y&&(k.anchor_anim(1,k.section_pos[1]+30),k.set_section_pos()),"asset-allocation-views"==y&&(k.anchor_anim(3),k.set_section_pos()),O.build_in("no-delay")}else O.build_in()},250)},C=function(){e=t(window),n=t("html, body"),a=t("html"),i=t("body"),r=t("header .header"),o=t("footer .footer"),s=i.find(".main-section #main-content"),l=s.find(".fixed-bg-img"),d=i.find(".main-section nav#main-menu"),u=d.find(".download-btn-container.international-only"),c=u.find("ul.lang-option"),h=i.find("#modal"),p=h.find(".modal-content"),f=s.find(".sect-tooltip")},w={isTouch:!1,init:function(){-1!=navigator.appVersion.indexOf("Win")&&a.addClass("os-win"),this.is_touch_device()&&(this.isTouch=!0,a.removeClass("noTouch"),document.addEventListener("touchstart",function(){},!0)),this.is_iOS()&&a.addClass("ios-device"),this.is_safari()&&a.addClass("safari")},is_touch_device:function(){return"ontouchstart"in window||navigator.maxTouchPoints},is_IE:function(){var t=window.navigator.userAgent,e=t.indexOf("MSIE "),n=t.indexOf("Trident/"),a=t.indexOf("Edge/");if(e>0)return parseInt(t.substring(e+5,t.indexOf(".",e)),10);if(n>0){const i=t.indexOf("rv:");return parseInt(t.substring(i+3,t.indexOf(".",i)),10)}return a>0&&parseInt(t.substring(a+5,t.indexOf(".",a)),10)},is_iOS:function(){return!(!/iPad|iPhone|iPod/.test(navigator.userAgent||navigator.vendor||window.opera)||window.MSStream)},is_safari:function(){var t=!1;return-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome")&&(t=!0),t}},T={width:0,height:0,m_view:!1,time:null,timeout:!1,delta:200,header_h:0,footer_y:0,sticky_y:0,$landing:null,$landing_nav:null,init:function(){T.width=e.width(),T.height=e.height(),T.header_h=r.height(),T.$landing=s.find("section.landing"),T.$landing_nav=s.find(".top-navbar"),T.sticky_y=T.$landing_nav.offset().top+T.$landing_nav.outerHeight(),T.set_img_ratio(),T.width<=639&&(T.sticky_y=T.$landing.offset().top+T.$landing.outerHeight()-60),e.width()<723?T.m_view=!0:T.m_view=!1,e.height()<781?a.addClass("short-vp"):a.removeClass("short-vp"),D.detail_box_elm&&D.detail_content_elm&&D.detail_box_elm.css("height",D.detail_content_elm.outerHeight()+"px"),w.isTouch?e.on("orientationchange",this.start.bind(this)):e.on("resize",this.start.bind(this))},start:function(){this.time=new Date;var t=k.$global_sect.offset().top-e.scrollTop(),n=k.$regional_sect.offset().top-e.scrollTop(),i=k.$assetclass_sect.offset().top-e.scrollTop(),r=O.$scroll_btn.offset().top-e.scrollTop();!1===T.timeout&&(T.timeout=!0,a.removeClass("noResize"),setTimeout(this.end,this.delta)),t<r?O.$scroll_btn.addClass("dark"):O.$scroll_btn.removeClass("dark"),n<r&&O.$scroll_btn.removeClass("dark"),i<r?O.$scroll_btn.addClass("fade-out"):O.$scroll_btn.removeClass("fade-out")},end:function(){new Date-this.time<this.delta?setTimeout(this.end,this.delta):(T.timeout=!1,a.addClass("noResize"),e.width()<723?T.m_view=!0:T.m_view=!1,e.height()<781?a.addClass("short-vp"):a.removeClass("short-vp"),T.width=e.width(),T.height=e.height(),T.header_h=r.height(),T.sticky_y=T.$landing_nav.offset().top+T.$landing_nav.outerHeight(),T.set_img_ratio(),T.width<=639&&(T.sticky_y=T.$landing.offset().top+T.$landing.outerHeight()-60),D.detail_box_elm&&D.detail_content_elm&&D.detail_box_elm.css("height",D.detail_content_elm.outerHeight()+"px"),I.resize(),k.set_section_pos(),S.resize(),P.initiated&&P.resize())},orig_img_w:1792,orig_img_h:1008,set_img_ratio:function(){var t=l.width()*T.orig_img_h/T.orig_img_w,e=l.find("img");t<l.height()?e.addClass("vert"):e.removeClass("vert")}},A={lastScrollTop:0,st:0,hash:!1,sticky_nav_disable:!1,init:function(){this.st=e.scrollTop(),this.st>T.sticky_y?d.addClass("on"):d.removeClass("on"),e.on("scroll",this.start.bind(this)),p.on("scroll",this.modal_scroll.bind(this))},instructions_detect:function(){f.each(function(n){var a=t(this).offset().top,i=a+t(this).outerHeight(),r=e.scrollTop(),o=r+e.height(),s=i>e.scrollTop()&&a<o,l=t(this).find(".close-tooltip");s&&t(this).addClass("on"),l.on("click",function(e){e.preventDefault(),e.stopPropagation(),t(this).parent().css("display","none")})})},start:function(){q.scroll_anim_disable=!0,this.st=e.scrollTop(),this.instructions_detect();var t=k.$global_sect.offset().top-this.st,n=k.$regional_sect.offset().top-this.st,a=k.$assetclass_sect.offset().top-this.st,i=O.$scroll_btn.offset().top-this.st;this.st>50&&(O.$start_btn&&O.$start_btn.removeClass("on"),O.started||O.anim_in()),this.st>T.sticky_y&&!this.sticky_nav_disable?d.addClass("on"):(O.$temp_disable_scroll||d.removeClass("on"),u.removeClass("on"),c.css("height","0")),t<i?O.$scroll_btn.addClass("dark"):O.$scroll_btn.removeClass("dark"),n<i&&O.$scroll_btn.removeClass("dark"),a<i?O.$scroll_btn.addClass("fade-out"):O.$scroll_btn.removeClass("fade-out"),D.scroll_checker(this.st),this.st>=this.lastScrollTop?k.set_id_by_pos(this.st,"down"):k.set_id_by_pos(this.st,"up"),this.lastScrollTop=this.st,k.$page_nav.attr("data-active-section",k.id)},touchScrollLock:function(t){return t.preventDefault(),t.stopPropagation(),!1},modal_scroll:function(){q.scroll_checker(this.st)}},k={$regional_sect:null,$regional_nav_sect:null,$assetclass_sect:null,$stat:null,$stat_countries:null,$stat_gdp:null,$stat_pop:null,$assetclass_btn:null,$regional_btn:null,$page_nav:null,$page_nav_btns:null,$mobile_active_sect:null,id:0,id_len:4,section_pos:null,region_name:["us","inter","em"],init:function(){k.$global_sect=s.find("section.map"),k.$regional_sect=s.find("section.regional-nav"),k.$regional_nav_sect=k.$regional_sect.find("ul.btns"),k.$assetclass_sect=s.find("section#asset-class"),k.$stat=d.find(".map ul.stats li"),k.$stat_countries=k.$stat.eq(0).find("p span"),k.$stat_gdp=k.$stat.eq(1).find("p span"),k.$stat_pop=k.$stat.eq(2).find("p span"),k.$assetclass_btn=d.find("a.asset-class-btn"),k.$regional_btn=d.find("a.regional-view"),k.$page_nav=d.find("ul.page-nav"),k.$page_nav_btns=d.find("ul.page-nav li a"),k.$mobile_active_sect=d.find("#mobile-active-sect"),k.$mobile_active_text=d.find("#mobile-active-sect span"),k.$mobile_download=d.find(".page-nav .mobile-download-btn"),T.width<341&&k.$mobile_active_text.text("Menu"),this.set_section_pos(),this.set_id_by_pos(e.scrollTop(),"down"),k.$mobile_active_sect.on("click",this.mobile_nav_toggle.bind(this)),t.each(k.$page_nav_btns,function(e,n){t(n).parent().hasClass("mobile-download-btn")||t(n).on("click",function(n){if(n.preventDefault(),n.stopPropagation(),!$){var a=t(n.currentTarget);a.attr("href"),String(_).indexOf("?")?String(_).split("?")[0]:String(_),a.parent().parent().attr("class")}i.hasClass("no-scroll")&&i.removeClass("no-scroll"),d.hasClass("mobile-active")&&d.removeClass("mobile-active"),k.$mobile_download.hasClass("btn-fade-in")&&k.$mobile_download.removeClass("btn-fade-in"),k.$mobile_active_sect.hasClass("open")&&(k.$mobile_active_sect.removeClass("open"),k.$page_nav.slideUp()),k.$page_nav.attr("data-active-section",e),k.anchor_anim(e)})})},mobile_btn_fade:function(){k.$mobile_download.addClass("btn-fade-in")},mobile_nav_toggle:function(e){e.preventDefault(),e.stopPropagation();var n=k.$mobile_active_sect;i.hasClass("no-scroll")?i.off("touchmove",A.touchScrollLock(e)):i.on("touchmove",A.touchScrollLock(e)),d.toggleClass("mobile-active"),i.toggleClass("no-scroll"),t(n).toggleClass("open"),k.$page_nav.slideToggle(),k.$mobile_download.hasClass("btn-fade-in")?k.$mobile_download.removeClass("btn-fade-in"):(clearTimeout(k.mobile_btn_fade),setTimeout(function(){k.mobile_btn_fade()},400)),T.width>341?t(n).hasClass("open")?k.$mobile_active_text.text("Close Menu"):1===k.id?k.$mobile_active_text.text("Global Landscape"):2===k.id?k.$mobile_active_text.text("Global Landscape"):k.$mobile_active_text.text("Asset Allocation Views"):k.$mobile_active_text.text("Menu")},assetclass_link:function(e){if(e.preventDefault(),e.stopPropagation(),!$){var n=t(e.currentTarget),a=(n.attr("href"),String(_).indexOf("?")?String(_).split("?")[0]:String(_));n.parent().attr("class");a.indexOf("#")&&a.split("?")[0]}k.anchor_anim(4)},regional_link:function(e){if(e.preventDefault(),e.stopPropagation(),!$){var n=t(e.currentTarget),a=(n.attr("href"),String(_).indexOf("?")?String(_).split("?")[0]:String(_));a.indexOf("#")&&a.split("?")[0]}i.is(".us, .inter, .em")?k.anchor_anim(2):k.anchor_anim(2,Math.round(k.$regional_sect.offset().top-60))},set_section_pos:function(){k.section_pos=[];k.section_pos.push(0),k.section_pos.push(Math.round(k.$global_sect.offset().top-60)),k.section_pos.push(Math.round(k.$regional_sect.offset().top-60)),k.section_pos.push(Math.round(k.$assetclass_sect.offset().top-60))},set_id_by_pos:function(t,e){"down"==e?k.id<k.id_len-1&&t>=k.section_pos[k.id+1]-.25*T.height&&k.set_id(k.id+1):k.id>0&&t<k.section_pos[k.id]-.25*T.height&&k.set_id(k.id-1),b&&(1==k.id&&(S.$bg_img.hasClass("on")||S.$bg_img.addClass("on"),t>=k.section_pos[k.id]-.25*T.height&&S.intro_played&&S.intro_end(),T.width>341&&k.$mobile_active_text.text("Global Landscape")),2==k.id&&(T.width>341&&k.$mobile_active_text.text("Regional Views"),k.$regional_sect.addClass("on"),setTimeout(function(){k.$regional_sect.addClass("remove-text-delay")},1e3)),3==k.id&&T.width>341&&k.$mobile_active_text.text("Asset Allocation Views"),4==k.id&&t>=k.section_pos[k.id]-.75*T.height&&D.anim_in())},set_id:function(t){k.id=t},anchor_anim:function(t,e){var a=e||k.section_pos[t],i=t&&Math.abs(t-k.id)>=2?1e3:500;n.animate({scrollTop:a},i,"easeInOutCubic")}},O={$cont:null,$bg:null,$head:null,$title:null,$assetclass_btn:null,$start_btn:null,$scroll_btn:null,$download_btn:null,download_btn_h:0,download_btn_h_lg:0,started:!1,init:function(){O.$cont=s.find("section.landing"),O.$bg=O.$cont.find(".bg-container"),O.$head=O.$bg.find(".head"),O.$title=O.$head.find(".title"),O.$assetclass_btn=O.$cont.find("a.asset-class-btn"),O.$start_btn=i.find("span.start-btn"),O.$download_btn="international"===v?i.find(".download-btn-container.international-only"):i.find(".download-btn-container"),O.$scroll_btn=s.find("#scroll-btn"),O.$assetclass_btn.on("click",O.asset_scroll.bind(this)),O.$scroll_btn.on("click",O.scroll_down.bind(this)),O.$temp_disable_scroll=!1,O.download_btn_h=52,O.download_btn_h_lg=208,w.isTouch?O.$download_btn.find("a.download-btn").on("click",O.download_option.bind(this)):O.$download_btn.on("mouseover mouseout",O.download_option.bind(this)),O.$download_btn.find("ul.lang-option").addClass("ready"),l.addClass("img-on")},download_option:function(e){e.preventDefault(),e.stopPropagation();var n,a,i,r=e.type;"click"===r?(n=t(e.currentTarget).parent(),a=n.find("ul.lang-option"),i=n.hasClass("international-only")?O.download_btn_h:O.download_btn_h_lg,n.hasClass("on")?(n.removeClass("on"),a.removeAttr("style")):(n.addClass("on"),a.css("height",i+"px"))):(n=t(e.currentTarget),a=n.find("ul.lang-option"),"mouseover"===r?(i=n.hasClass("international-only")?O.download_btn_h:O.download_btn_h_lg,n.addClass("on"),a.css("height",i+"px")):"mouseout"===r&&(n.removeClass("on"),a.removeAttr("style")))},asset_scroll:function(e){if(e.preventDefault(),e.stopPropagation(),!$){var n=t(e.currentTarget),a=(n.attr("href"),String(_).indexOf("?")?String(_).split("?")[0]:String(_));n.parent().attr("class");a.indexOf("#")&&a.split("?")[0]}k.anchor_anim(3)},scroll_down:function(e){if(e.preventDefault(),e.stopPropagation(),!$){t(e.currentTarget)}O.$temp_disable_scroll=!0,setTimeout(function(){O.$temp_disable_scroll=!1},500),setTimeout(function(){d.addClass("on")},250),k.anchor_anim(k.id+1)},build_in:function(t){"no-delay"===t&&(O.$head.addClass("on no-delay"),O.anim_in(),O.$start_btn.addClass("on no-delay"),l.addClass("video-done")),w.isTouch?(setTimeout(function(){O.$head.addClass("on"),setTimeout(function(){T.width<=639?T.sticky_y=T.$landing.offset().top+T.$landing.outerHeight()-60:T.sticky_y=T.$landing_nav.offset().top+T.$landing_nav.outerHeight()},1650)},1400),setTimeout(function(){O.anim_in()},1200),setTimeout(function(){O.$start_btn.addClass("on")},1750),setTimeout(function(){l.addClass("video-done")},1500)):(setTimeout(function(){O.$head.addClass("on"),setTimeout(function(){T.width<=639?T.sticky_y=T.$landing.offset().top+T.$landing.outerHeight()-60:T.sticky_y=T.$landing_nav.offset().top+T.$landing_nav.outerHeight()},1650)},1e3),setTimeout(function(){O.anim_in()},1200),setTimeout(function(){O.$start_btn.addClass("on")},1750),setTimeout(function(){l.addClass("video-done")},1500))},anim_in:function(){O.started||(O.started=!0,O.$head.addClass("start"),setTimeout(function(){O.$scroll_btn.removeClass("scroll-intro")},1600))}},M={init:function(){f.each(function(){t(this).find(".bb-close").on("click",function(e){e.preventDefault(),e.stopPropagation(),t(this).parent().css("display","none")})})}},I={$player:null,myPlayer:null,p_data:{accountId:"24488480001",playerId:"ryQ1wVtwl",videoId:"5365799838001",preload:"auto",allowfullscreen:"true",webkitallowfullscreen:"true",mozallowfullscreen:"true",oallowfullscreen:"true",msallowfullscreen:"true",htmlFallback:"false"},init:function(){I.$player=l.find(".video");var e=I.$player.attr("src-id")?I.$player.attr("src-id"):I.p_data.videoId,n=I.$player.attr("player-id")?I.$player.attr("player-id"):I.p_data.playerId,a='<video id="vPlayer" data-video-id="'+e+'" data-account="'+I.p_data.accountId+'" data-player="'+n+'" data-embed="default"';a+=' preload="'+I.p_data.preload+'" allowfullscreen="'+I.p_data.allowfullscreen+'" webkitallowfullscreen="'+I.p_data.webkitallowfullscreen+'" mozallowfullscreen="'+I.p_data.mozallowfullscreen+'"',a+=' oallowfullscreen="'+I.p_data.oallowfullscreen+'" msallowfullscreen="'+I.p_data.msallowfullscreen+'" htmlFallback="'+I.p_data.htmlFallback+'"',a+=' autoplay class="video-js" muted="true" loop="true" controls="false"></video>',I.$player.html(a),t.getScript("//players.brightcove.net/"+I.p_data.accountId+"/"+n+"_default/index.min.js",function(t,e,n){console.log(t),console.log(e),console.log(n.status),console.log("Load was performed."),I.run(),I.resize()}),I.resize()},resize:function(){if(I.$player){var t=I.$player.height(),e=16*t/9;T.m_view;e<T.width&&(e=T.width,t=9*e/16),t<=T.height&&(t=T.height,e=16*t/9),I.$player.find(".video-js .vjs-tech")?I.$player.find(".video-js .vjs-tech").css({width:e+"px",height:t+"px"}):I.$player.find(".video-js video").css({width:e+"px",height:t+"px"})}},run:function(){videojs("vPlayer").on("loadedmetadata",function(){var t;I.myPlayer=this,I.myPlayer.duration(),I.resize(),I.myPlayer.currentTime(0),I.myPlayer.play(),l.addClass("video-on"),I.myPlayer.on("timeupdate",function(){t=Math.round(this.currentTime())})})},stop:function(){I.myPlayer.pause()}},S={$bg:null,$cont:null,$instructions:null,$heat_btns:null,$heat_legend:null,$heat_legend_item:null,$heat_legend_label:null,$heat_sources:null,projection:null,path:null,svg:null,tooltip:null,attribute_array:[],cur_attribute:0,intro_played:!1,intro_ending:!1,intro_timer:null,width:0,height:0,timer:null,heat_change_done:!0,heat_btn_ready:!0,heat_id:0,heat_color:[["#eaeaea","#4c5901","#728300","#99b000","#abc500","#bfd916"],["#eaeaea","#003d5a","#015c89","#007bb4","#009ae2","#009ae2"],["#eaeaea","#63330b","#944d0f","#c66610","#df7311","#f88012"]],legend_text:[["Contracting","Expanding"],["Tightening","Easing"],["-1% &gt;","&lt; 1%"]],policy_val:["Easing, last move easing","Easing, last move tightening","Tightening, last move easing","Tightening, last move tightening"],sources:["Haver, 9/30/2018.","Haver, 9/30/2018.","Bloomberg, 9/30/2018."],init:function(){S.$bg=s.find("section.map .bg-container"),S.$bg_img=s.find("section.map .bg-global"),S.$cont=s.find("section.map .map-wrapper"),S.$instructions=s.find("section.map .bb-tool-tip"),S.$heat_btns=s.find("section.map ul.heat-btns li"),S.$heat_legend=s.find("section.map .heat-legend"),S.$heat_legend_item=S.$heat_legend.find("ul li"),S.$heat_legend_label=S.$heat_legend.find("span.heat-label"),S.$heat_sources=s.find("section.map .map-container p.footnote"),S.set(),S.$heat_btns.find("a").on("click",function(e){e.preventDefault(),e.stopPropagation();var n=t(e.currentTarget),a=n.parent().index();S.heat_btn_ready&&!S.$heat_btns.eq(a).hasClass("on")&&(S.heat_btn_ready=!1,S.intro_played?(S.heat_change_done?S.heat_map(a,!1):S.heat_map(a,!0),S.legend(a),S.heat_change_done=!1,S.$heat_btns.removeClass("on"),S.$heat_btns.eq(a).addClass("on"),setTimeout(function(){S.heat_id=a},1050)):S.intro_end(),setTimeout(function(){S.heat_change_done=!0},1250),setTimeout(function(){S.heat_btn_ready=!0},500)),S.$instructions.css("display","none")})},legend:function(t){S.$heat_legend.removeClass("legend-1 legend-2 legend-3"),S.$heat_legend.addClass("legend-"+(t+1)),S.$heat_legend_label.eq(0).html(S.legend_text[t][0]),S.$heat_legend_label.eq(1).html(S.legend_text[t][1]),S.$heat_legend_label.eq(2).html(S.legend_text[t][0]),S.$heat_legend_label.eq(3).html(S.legend_text[t][1])},set:function(){S.width=S.$cont.width(),S.height=S.$cont.height(),S.projection=d3.geo.eckert3().scale(200).translate([S.width/2,S.height/2]).precision(.1),S.path=d3.geo.path().projection(S.projection),S.svg=d3.select("#map").append("svg").attr("width",S.width).attr("height",S.height),S.tooltip=d3.select(".map-container").append("div").attr("class","hidden map-box"),S.load_data()},resize:function(){var t=.517*S.$cont.width();S.$cont.css("height",t+"px"),S.width=S.$cont.width(),S.height=S.$cont.height(),S.svg.attr("width",S.width).attr("height",S.height),S.projection.translate([S.width/2,S.height/2]).scale(200*S.width/1040),d3.selectAll(".country").attr("d",S.path),k.set_section_pos()},load_data:function(){queue().defer(d3.json,m+"../outlook/data/world-topo.json").defer(d3.tsv,m+"../outlook/data/heatmap-data-2018-12-4.tsv").await(S.process_data)},process_data:function(t,e,n){if(t)throw t;var a=e.objects.countries.geometries;for(var i in a)for(var r in n)if(a[i].properties.id==n[r].id){for(var o in n[r])"name"!=o&&"id"!=o&&(-1==S.attribute_array.indexOf(o)&&S.attribute_array.push(o),a[i].properties[o]=n[r][o]);break}S.draw_map(e),S.resize()},draw_map:function(t){S.svg.selectAll(".country").data(topojson.feature(t,t.objects.countries).features).enter().append("path").attr("class","country").attr("id",function(t){return"code_"+t.properties.id},!0).attr("d",S.path),d3.selectAll(".country").attr("fill-opacity",0),d3.select("#code_ATA").style({display:"none"}),d3.select("#code_ATF").style({display:"none"}),d3.selectAll(".country").attr("fill",function(t){return"#ffffff"}).attr({"fill-opacity":0,stroke:"#2f2f2f","stroke-opacity":.1}),d3.selectAll(".country").each(function(t,e){var n=B.randomNum(0,35);n=n>30?35:n,n=n<5?5:n,n*=.01,d3.select(this).attr("stroke-opacity",Number(n))}),S.intro_begin()},intro_begin:function(){0==S.intro_played&&(S.intro_played=!0,w.isTouch?(S.intro_ending=!0,S.$cont.addClass("intro-done"),S.$cont.removeClass("intro"),S.$cont.removeClass("intro-ending"),d3.selectAll(".country").attr("fill",function(t){var e=Number(t.properties[S.attribute_array[0]]);return e=e||0,S.heat_color[S.heat_id][e]}).attr({"fill-opacity":1,stroke:"#bdbdbd","stroke-opacity":.5}),a.hasClass("noTouch")&&d3.selectAll(".country").on("mouseover",S.hover).on("mouseout",S.hout),s.find("section.map .heat-nav").animate({opacity:1},250),l.addClass("video-done"),S.$cont.removeClass("intro-done"),S.$cont.removeClass("intro"),S.$heat_sources.html("<strong>Sources:&nbsp;&nbsp;</strong>"+S.sources[0]),S.$heat_btns.eq(0).addClass("on"),S.$heat_legend.addClass("on"),S.legend(0)):(S.$cont.hasClass("intro")||S.$cont.addClass("intro"),d3.selectAll(".country").each(function(t,e){var n=B.randomNum(0,50);n=n>45?50:n-15,n=n<0?0:n,n*=.01;var a=B.randomNum(0,50);a-=15,a=a<0?0:a,a*=.01,d3.select(this).attr("stroke-opacity",Number(n)).attr("fill-opacity",Number(a))}),S.$heat_sources.html("<strong>Sources:&nbsp;&nbsp;</strong>"+S.sources[0])))},intro_end:function(){0==S.intro_ending&&(S.intro_ending=!0,S.$cont.hasClass("intro")&&(S.$cont.addClass("intro-done"),S.$cont.removeClass("intro")),d3.selectAll(".country").attr("fill",function(t){var e=Number(t.properties[S.attribute_array[0]]);return e=e||0,S.heat_color[S.heat_id][e]}).attr({"fill-opacity":1,stroke:"#bdbdbd","stroke-opacity":.5}),a.hasClass("noTouch")&&d3.selectAll(".country").on("mouseover",S.hover).on("mouseout",S.hout),s.find("section.map .heat-nav").animate({opacity:1},250),S.$heat_btns.eq(0).addClass("on"),S.$heat_legend.addClass("on"),S.legend(0),l.addClass("video-done"),S.$cont.removeClass("intro-done"),S.$cont.removeClass("intro"),S.$heat_sources.html("<strong>Sources:&nbsp;&nbsp;</strong>"+S.sources[0]))},intro:function(){if(0==S.intro_played)if(S.intro_played=!0,s.find("section.map .heat-nav").animate({opacity:1},150),s.find("section.landing .bg-container").animate({"background-color":"rgba(255,255,255,0.95)"},1500,"easeInOutCubic"),s.find("section.map .bg-container").animate({"background-color":"rgba(255,255,255,0.95)"},1500,"easeInOutCubic"),w.isTouch)S.$heat_legend.addClass("on"),S.$heat_btns.eq(0).addClass("on"),S.legend(0),d3.selectAll(".country").each(function(t,e){d3.select(this).attr({"fill-opacity":1,"stroke-opacity":.5})}),S.$heat_sources.html("<strong>Sources:&nbsp;&nbsp;</strong>"+S.sources[0]);else{setTimeout(function(){S.$heat_legend.addClass("on")},250),setTimeout(function(){S.$heat_btns.eq(0).addClass("on"),S.legend(0)},1250);var t,e=0,n=0;clearInterval(t),t=null,t=setInterval(function(){n<100?(n=e+25,d3.selectAll(".country").each(function(t,a){var i=B.randomNum(e,n+10);i=i>100?100:i,d3.select(this).attr("fill-opacity",Number(.01*i))}),e=n):(clearInterval(t),t=null,d3.selectAll(".country").each(function(t,e){d3.select(this).attr({"fill-opacity":1,"stroke-opacity":.5})}),S.$heat_sources.html("<strong>Sources:&nbsp;&nbsp;</strong>"+S.sources[0]))},150)}},heat_map:function(t,e){0==S.intro_played&&(S.intro_played=!0),S.$heat_sources.html("<strong>Sources:&nbsp;&nbsp;</strong>"+S.sources[t]),d3.selectAll(".country").each(function(n,a){var i=S.heat_color[S.heat_id].indexOf(d3.select(this).attr("fill")),r=Number(n.properties[S.attribute_array[t]]);r=r&&""!=r&&void 0!=r?r:0,e&&(S.heat_id=t),w.isTouch?d3.select(this).attr("fill",S.heat_color[t][r]):S.remove_color_anim(this,i,r,t,e),d3.select(this).attr("fill-opacity",1)})},remove_color_anim:function(t,e,n,a,i){if(i)setTimeout(function(){n>0?d3.select(t).attr("fill","#2f2f2f"):d3.select(t).attr("fill",S.heat_color[a][n])},250),setTimeout(function(){S.add_color_anim(t,0,n,a)},500);else if(e>0){var r=e-1;r<=0?d3.select(t).attr("fill","#2f2f2f"):d3.select(t).attr("fill",S.heat_color[S.heat_id][r]),setTimeout(function(){S.remove_color_anim(t,r,n,a,!1)},50)}else setTimeout(function(){S.add_color_anim(t,0,n,a)},50)},add_color_anim:function(t,e,n,a){if(e<n){var i=e+1;d3.select(t).attr("fill",S.heat_color[a][i]),setTimeout(function(){S.add_color_anim(t,i,n,a)},50)}else d3.select(t).attr("fill",S.heat_color[a][n])},map_hover_timer:null,hover:function(e,n){if(!T.m_view){var a,i=d3.mouse(d3.select(".map-container").node()).map(function(t){return parseInt(t)}),r=S.$heat_btns.eq(S.heat_id).find("a").html(),o=e.properties[r+" val"];if("Real Yields"==r&&(a=[],a.push(e.properties[r+" val2"]),a.push(e.properties[r+" val3"])),""!==o&&void 0!==o&&"n/a"!==o){d3.select(this).attr({stroke:"#4c4c4c","stroke-opacity":1});var s='<div class="name">'+e.properties.admin+"</div>";"Real Yields"==r?(r=r.substr(0,r.length-1),s+='<div class="stat col">'+r+": <strong>"+B.roundNum(o,1)+"<sub>%</sub></strong></div>",s+='<div class="stat col">CPI: <strong>'+B.roundNum(a[0],1)+"<sub>%</sub></strong></div>",s+='<div class="stat col">Nominal Yield: <strong>'+B.roundNum(a[1],1)+"<sub>%</strong></div></div>"):"Policy"==r?s+='<div class="stat dark">'+o+"</div>":(s+='<div class="stat col">'+r+": <strong>"+B.roundNum(o,1)+"</strong>",s+=o>50?"<span>(Expanding economy)</span></div>":"<span>(Contracting economy)</span></div>"),S.tooltip.classed("hidden",!1).html(s).attr("style",function(){var e="left: ",n=t(this).width();return i[0]+n+100>T.width?e+=i[0]-(n+75)+"px; ":e+=i[0]+25+"px; ",e+="top: "+(i[1]-60)+"px;"}),window.clearTimeout(S.map_hover_timer),$||(S.map_hover_timer=window.setTimeout(function(){},1e3))}}},hout:function(t,e){window.clearTimeout(S.map_hover_timer),d3.select(this).attr({stroke:"#bdbdbd","stroke-opacity":.5}),S.tooltip.classed("hidden",!0).html("")}},q={$cont:null,$nav:null,$nav_btns:null,$head:null,$chart_top:null,$chart_title:null,$infograph_top:null,$column_top:null,$region_btns:null,$modal_close:null,$modal_nav:null,scroll_anim_disable:!1,region_click_disable:!1,id:0,intro_played:[!1,!1,!1],init:function(){this.$cont=s.find("section.regional"),q.$nav=s.find("section.regional-nav ul.btns"),q.$nav_btns=q.$nav.find("li"),q.$instructions=s.find("section.regional-nav .bb-tool-tip"),q.$head=h.find("ul.head > li"),q.$chart_top=h.find(".chart-wrapper"),q.$chart_title=q.$chart_top.find("h6.title"),q.$infograph_top=h.find(".infograph-wrapper"),q.$column_top=h.find(".column-wrapper .column-wrap"),q.$modal_close=h.find(".modal-close"),q.$modal_sections=h.find(".row"),q.$modal_nav_btns=h.find(".modal-nav li a"),q.$region_btns=q.$nav_btns.find("a"),q.$region_btns.on("click",q.select.bind(this)),q.$modal_close.on("click",q.close.bind(this)),q.$modal_nav_btns.on("click",q.modal_nav_select.bind(this))},select:function(e){e.preventDefault(),e.stopPropagation();var n=t(e.currentTarget),a=n.parent(),r=a.index();T.height>580?this.region_click_disable||(this.region_click_disable=!0,i.removeClass("us inter em"),q.open_region(r)):(A.sticky_nav_disable=!0,q.id=r,q.expand(r),i.addClass("no-scroll"),h.addClass("on"),h.attr("data-active-region",r),h.css("transition-delay","0s"),p.scrollTop(0))},open_region:function(t){A.sticky_nav_disable=!0,q.id=t,setTimeout(function(){q.expand(t),k.$regional_nav_sect.addClass("modal-bg-anim"),q.region_click_disable=!1},1e3),setTimeout(function(){k.$regional_nav_sect.addClass("hide-text")},500),k.$regional_nav_sect.attr("data-active-btn",t),k.$regional_nav_sect.addClass("sibling-slider"),k.$regional_sect.addClass("regional-full-height"),k.anchor_anim(2),O.$scroll_btn.css("display","none"),i.addClass("no-scroll"),a.addClass("noAnim"),h.addClass("on"),h.attr("data-active-region",t),p.scrollTop(0),T.width<640?setTimeout(function(){d.removeClass("on")},935):setTimeout(function(){d.removeClass("on")},500)},expand:function(t){i.addClass(k.region_name[t]),P.initiated?P.update(t):P.init(t),q.intro_played[t]||q.intro(t)},intro:function(t){q.intro_played[t]=!0;var e=q.$head.eq(t).find(".stats p"),n=e.eq(0).find("span"),a=e.eq(1).find("span"),i=e.eq(2).find("span"),r=n.html(),o=a.html(),s=i.html(),l=o.substr(o.length-1),d=s.substr(s.length-1);o=o.substring(1,o.length-1),s=s.substring(0,s.length-1),w.isTouch?(n.html(r),a.html("$"+o+l),i.html(s+d),n.hasClass("on")||n.addClass("on"),a.hasClass("on")||a.addClass("on"),i.hasClass("on")||i.addClass("on")):(q.intro_anim(n,r,"","",0),q.intro_anim(a,o,l,"$",500),q.intro_anim(i,s,d,"",750))},intro_anim:function(t,e,n,a,i){t.removeClass("on");var r=0,o=e,s=""==n?null:n,l=""==a?null:a,d=o%1!=0,u=d?.1:1;o>100&&(r=o-B.randomNum(30,60)),d&&o>15&&(r=o-.1*B.randomNum(20,50)),r=r%1!=0?Math.round(10*r)/10:r;var c=l?l+r:r;c=s?c+s:c,t.html(c),setTimeout(function(){var e=setInterval(function(){r>=o?(r=o,clearInterval(e),e=null):r+=u,r=r%1!=0?Math.round(10*r)/10:r;var n=l?l+r:r;d&&r%1==0&&(n+=".0"),n=s?n+s:n,t.html(n)},30);t.hasClass("on")||t.addClass("on")},i)},scroll_checker:function(t){q.intro_played[q.id]&&t>=q.$column_top.offset().top+.5*q.$column_top.height()-T.height&&b&&P.initiated&&P.draw()},close:function(t){t.preventDefault(),t.stopPropagation(),T.height>580?this.region_click_disable||(this.scroll_anim_disable=!1,this.region_click_disable=!0,A.sticky_nav_disable=!1,k.$regional_nav_sect.removeClass("sibling-slider modal-bg-anim"),setTimeout(function(){k.$regional_sect.removeClass("regional-full-height"),k.$regional_nav_sect.attr("data-active-btn",""),k.$regional_nav_sect.removeClass("hide-text"),a.removeClass("noAnim"),k.set_section_pos(),q.region_click_disable=!1,q.scroll_anim_disable||k.anchor_anim(2)},1400),O.$scroll_btn.css("display","block"),k.$regional_nav_sect.removeClass("quick-open"),d.addClass("on"),i.removeClass("no-scroll"),h.removeClass("on"),h.attr("data-active-region","")):(q.$nav.attr("data-active-btn",""),q.$nav.removeClass("sibling-slider hide-text modal-bg-anim quick-open"),k.$regional_sect.attr("data-section-number",""),k.$regional_sect.removeClass("remove-text-delay regional-full-height"),i.removeClass("no-scroll"),h.removeClass("on"),h.attr("data-active-region",""))},modal_nav_select:function(e){e.preventDefault(),e.stopPropagation();var n=t(e.currentTarget),a=n.parent(),i=a.index();T.height>580?(q.id=i,q.$modal_sections.css("opacity","0"),k.$regional_nav_sect.attr("data-active-btn",i),setTimeout(function(){q.expand(i),h.attr("data-active-region",i)},900),setTimeout(function(){p.animate({scrollTop:0},700,"easeInOutCubic")},200),setTimeout(function(){q.$modal_sections.css("opacity","1")},900)):(q.$modal_sections.css("opacity","0"),setTimeout(function(){h.attr("data-active-region",i),q.$modal_sections.css("opacity","1")},900),setTimeout(function(){p.animate({scrollTop:0},700,"easeInOutCubic")},200))}},P={tooltip:null,initiated:!1,id:0,data_path:"data/valuation-2018-11-30.tsv",margin:{top:30,right:20,bottom:70,left:74.5},width:0,height:0,x1:0,x2:0,y1:0,y2:0,xAxis1:null,xAxis2:null,yAxis1:null,yAxis2:null,line1:null,line2:null,svg1:null,svg2:null,data:null,group:null,item1:null,item2:null,point1:null,point2:null,pattern1:null,pattern2:null,bar1:null,bar2:null,intro_played:[!1,!1,!1],init:function(t){P.initiated||(P.id=t,P.tooltip=d3.select(".column-wrapper > .chart-tooltip"),P.width=q.$column_top.width()-P.margin.left-P.margin.right,P.height=q.$column_top.height()-P.margin.top-P.margin.bottom,P.set_var("#column-chart-","column-chart"),P.load_data(m+P.data_path))},set_var:function(t,e){P.x1=d3.scale.ordinal().rangeBands([0,P.width],0),P.x2=d3.scale.ordinal().rangeBands([0,P.width],0),P.y1=d3.scale.linear().range([P.height,0]),P.y2=d3.scale.linear().range([P.height,0]),P.xAxis1=d3.svg.axis().scale(P.x1).innerTickSize(0).outerTickSize(0).orient("bottom"),P.xAxis2=d3.svg.axis().scale(P.x2).innerTickSize(0).outerTickSize(0).orient("bottom"),P.yAxis1=d3.svg.axis().scale(P.y1).ticks(5).innerTickSize(5).outerTickSize(0).orient("left");var n=T.m_view?"left":"right";P.yAxis2=d3.svg.axis().scale(P.y2).ticks(5).innerTickSize(5).outerTickSize(0).orient(n),
P.line1=d3.svg.line().interpolate("basis").x(function(t){return P.x1(t.item)}).y(function(t){return P.y1(t.value)}),P.line2=d3.svg.line().interpolate("basis").x(function(t){return P.x2(t.item)}).y(function(t){return P.y2(t.value)}),P.svg1=d3.select(t+"left").append("svg").attr("class",e).attr("width",P.width+P.margin.left+P.margin.right).attr("height",P.height+P.margin.top+P.margin.bottom).append("g").attr("transform","translate("+P.margin.left+","+P.margin.top+")"),P.svg2=d3.select(t+"right").append("svg").attr("class",e).attr("width",P.width+P.margin.left+P.margin.right).attr("height",P.height+P.margin.top+P.margin.bottom).append("g").attr("transform",function(){return T.m_view?"translate("+P.margin.left+","+P.margin.top+")":"translate("+P.margin.right+","+P.margin.top+")"})},load_data:function(t){d3.tsv(t,function(t,e){P.data=e,P.group={equity:[],fixed_income:[]},P.data.map(function(t,e){e<=2?P.group.equity.push({name:t.item,values:{Current:+t.Current,Average:+t.Average,"Discount/Premium":+t["Discount/Premium"]},tooltip:t.Tooltip}):P.group.fixed_income.push({name:t.item,values:{Current:+t.Current,Average:+t.Average,"Discount/Premium":+t["Discount/Premium"]},tooltip:t.Tooltip})}),P.x1.domain(P.group.equity.map(function(t){return t.name})),P.x2.domain(P.group.fixed_income.map(function(t){return t.name})),P.y1.domain([d3.min(P.group.equity,function(t){return 0}),d3.max(P.group.equity,function(t){return t.values.Current+.035})]),P.y2.domain([d3.min(P.group.fixed_income,function(t){return 0}),d3.max(P.group.fixed_income,function(t){return t.values.Current+.035})]),P.svg1.append("g").attr("class","x axis").attr("transform","translate(0, "+(P.height-.5)+")").call(P.xAxis1).selectAll("text").attr("transform","translate(0, 20)").call(P.wrapper,P.x1.rangeBand()),P.svg2.append("g").attr("class","x axis").attr("transform","translate(0, "+(P.height-.5)+")").call(P.xAxis2).selectAll("text").attr("transform","translate(0, 20)").call(P.wrapper,P.x2.rangeBand()),P.svg1.append("g").attr("class","y axis").call(P.yAxis1).selectAll("text").attr("transform","translate(-10, 0)"),P.svg2.append("g").attr("class","y axis").attr("transform",function(){if(!T.m_view)return"translate("+(P.width-0)+", 0)"}).call(P.yAxis2).selectAll("text").attr("transform",function(){return T.m_view?"translate(-10, 0)":"translate(10, 0)"});for(var n=0;n<P.group.equity.length-1;n++)P.svg1.append("line").attr({class:"divider-line"+n,x1:P.width*(.3333*(n+1)),x2:P.width*(.3333*(n+1)),y1:0,y2:P.height,fill:"none","shape-rendering":"crispEdges",stroke:"#f3f3f3","stroke-width":"1px"});for(var n=0;n<P.group.fixed_income.length-1;n++)P.svg2.append("line").attr({class:"divider-line"+n,x1:P.width*(.3333*(n+1)),x2:P.width*(.3333*(n+1)),y1:0,y2:P.height,fill:"none","shape-rendering":"crispEdges",stroke:"#f3f3f3","stroke-width":"1px"});P.svg1.append("line").attr({class:"controlled-xAxis",x1:0,x2:P.width,y1:P.y1(0),y2:P.y1(0),fill:"none","shape-rendering":"crispEdges",stroke:"#cfcfcf","stroke-width":"1px"}),P.svg2.append("line").attr({class:"controlled-xAxis",x1:0,x2:P.width,y1:P.y2(0),y2:P.y2(0),fill:"none","shape-rendering":"crispEdges",stroke:"#cfcfcf","stroke-width":"1px"}),P.svg1.append("text").attr("class","axis-label").attr("text-anchor","middle").attr("transform","translate("+-1*P.margin.left*.75+", "+(.5*P.height+5)+") rotate(-90)").text("Price-to-Sales Ratio"),P.svg2.append("text").attr("class","axis-label").attr("text-anchor","middle").attr("transform",function(){return T.m_view?"translate("+-1*P.margin.left*.75+", "+(.5*P.height+5)+") rotate(-90)":"translate("+(P.width+.75*P.margin.left+10)+", "+(.5*P.height+5)+") rotate(-90)"}).text("Basis points"),P.item1=P.svg1.selectAll(".bar").data(P.group.equity).enter().append("rect").attr("class","bar").attr("x",function(t){return P.x1(t.name)+.3*P.x1.rangeBand()}).attr("width",.4*P.x1.rangeBand()).attr("fill",function(t,e){return e==P.id?"#bfd916":"#dfdfdf"}).attr("height",function(t){return P.intro_played[P.id]?Math.abs(P.y1(t.values.Current)-P.y1(0)):0}).attr("y",function(t){return P.intro_played[P.id]&&t.values.Current>0?P.y1(t.values.Current):P.y1(0)}),P.item2=P.svg2.selectAll(".bar").data(P.group.fixed_income).enter().append("rect").attr("class","bar").attr("x",function(t){return P.x2(t.name)+.3*P.x2.rangeBand()}).attr("width",.4*P.x2.rangeBand()).attr("fill",function(t,e){return e==P.id?"#bfd916":"#dfdfdf"}).attr("height",function(t){return P.intro_played[P.id]?Math.abs(P.y2(t.values.Current)-P.y2(0)):0}).attr("y",function(t){return P.intro_played[P.id]&&t.values.Current>0?P.y2(t.values.Current):P.y2(0)}),P.svg1.append("defs").append("pattern").attr("id","diagonalHatch").attr("patternUnits","userSpaceOnUse").attr("width",8).attr("height",8).append("path").attr("d","M-1,1 l4,-4 M0,8 l8,-8 M6,10 l4,-4").attr("stroke","#000000").attr("stroke-width",1).attr("stroke-opacity",.5),P.pattern1=P.svg1.selectAll(".pattern").data(P.group.equity).enter().append("rect").attr("class","pattern").attr("x",function(t){return P.x1(t.name)+.3*P.x1.rangeBand()}).attr("y",function(t){return P.intro_played[P.id]?t.values.Current>t.values.Average?P.y1(t.values.Current):P.y1(t.values.Average):t.values.Current>t.values.Average?P.y1(t.values.Average):P.y1(t.values.Current)}).attr("width",.4*P.x1.rangeBand()).attr("height",function(t){return P.intro_played[P.id]?Math.abs(P.y1(t.values.Current)-P.y1(t.values.Average)):0}).attr("fill","url(#diagonalHatch)").attr("stroke","#afafaf").attr("stroke-width",1).attr("stroke-opacity",1),P.pattern2=P.svg2.selectAll(".pattern").data(P.group.fixed_income).enter().append("rect").attr("class","pattern").attr("x",function(t){return P.x2(t.name)+.3*P.x2.rangeBand()}).attr("y",function(t){return P.intro_played[P.id]?t.values.Current>t.values.Average?P.y2(t.values.Current):P.y2(t.values.Average):t.values.Current>t.values.Average?P.y2(t.values.Average):P.y2(t.values.Current)}).attr("width",.4*P.x2.rangeBand()).attr("height",function(t){return P.intro_played[P.id]?Math.abs(P.y2(t.values.Current)-P.y2(t.values.Average)):0}).attr("fill","url(#diagonalHatch)").attr("stroke","#afafaf").attr("stroke-width",1).attr("stroke-opacity",1),P.point1=P.svg1.selectAll(".point").data(P.group.equity).enter().append("path").attr("class","point").attr("d",d3.svg.symbol().type("circle")).attr("transform",function(t,e){return"translate("+(.3333*P.width*.5+P.width*(.3333*e))+", "+P.y1(t.values.Average)+")"}),P.point2=P.svg2.selectAll(".point").data(P.group.fixed_income).enter().append("path").attr("class","point").attr("d",d3.svg.symbol().type("circle")).attr("transform",function(t,e){return"translate("+(.3333*P.width*.5+P.width*(.3333*e))+", "+P.y2(t.values.Average)+")"}),P.bar1=P.svg1.selectAll(".bar-frame").data(P.group.equity).enter().append("rect").attr("class","bar-frame").attr("x",function(t){return P.x1(t.name)+.3*P.x1.rangeBand()}).attr("width",.4*P.x1.rangeBand()).attr("fill","#ffffff").attr("fill-opacity",0).style("stroke","#000000").attr("stroke-opacity",function(){return P.intro_played[P.id]?.25:0}).attr("y",function(t){return t.values.Current>t.values.Average?P.y1(t.values.Current):P.y1(t.values.Average)}).attr("height",function(t){return t.values.Current>t.values.Average?Math.abs(P.y1(t.values.Current)-P.y1(0)):Math.abs(P.y1(t.values.Average)-P.y1(0))}),P.bar2=P.svg2.selectAll(".bar-frame").data(P.group.fixed_income).enter().append("rect").attr("class","bar-frame").attr("x",function(t){return P.x2(t.name)+.3*P.x2.rangeBand()}).attr("width",.4*P.x2.rangeBand()).attr("fill","#ffffff").attr("fill-opacity",0).style("stroke","#000000").attr("stroke-opacity",function(){return P.intro_played[P.id]?.25:0}).attr("y",function(t){return t.values.Current>t.values.Average?P.y2(t.values.Current):P.y2(t.values.Average)}).attr("height",function(t){return t.values.Current>t.values.Average?Math.abs(P.y2(t.values.Current)-P.y2(0)):Math.abs(P.y2(t.values.Average)-P.y2(0))}),P.initiated=!0,P.set_ui()})},column_hover_timer:null,set_ui:function(){P.bar1.on("mouseover",function(e,n){if(!T.m_view){var a=.3333*P.width,i=.7*a,r=a*n+P.margin.left+i,o=P.y1(.5*e.values.Current);r<0&&(r=0),P.tooltip.style("display","inline-block"),d3.select(this).attr("stroke-opacity",.75);var s=B.roundNum(e.values["Discount/Premium"],2),l='<div class="name">'+e.name+"</div>";l+='<div class="stat">Current: <div class="value">'+B.roundNum(e.values.Current,2)+"</div></div>",l+='<div class="stat">Average: <div class="value">'+B.roundNum(e.values.Average,2)+"</div></div>",l+='<div class="stat">'+(s>=0?"Premium":"Discount")+': <div class="value">'+s+"</div></div>",l+="<p>"+e.tooltip+"</p>",P.tooltip.html(l).style("left",function(){return r+20+"px"}).style("top",function(){var e=t(this).outerHeight();return o-.15*e+"px"}),P.tooltip.classed("right",!1),window.clearTimeout(P.column_hover_timer),$||(P.column_hover_timer=window.setTimeout(function(){},1e3))}}).on("mouseout",function(t){window.clearTimeout(P.column_hover_timer),P.tooltip.style("display","none"),d3.select(this).attr("stroke-opacity",.25)}),P.bar2.on("mouseover",function(e,n){if(!T.m_view){var a=.3333*P.width,i=.7*a,r=a*(n+3)+P.margin.right+P.margin.right+P.margin.left+i,o=P.y2(.5*e.values.Current);r<0&&(r=0),P.tooltip.style("display","inline-block"),d3.select(this).attr("stroke-opacity",.75);var s=B.roundNum(e.values["Discount/Premium"]),l='<div class="name">'+e.name+"</div>";l+='<div class="stat">Current: <div class="value">'+B.roundNum(e.values.Current,2)+"</div></div>",l+='<div class="stat">Average: <div class="value">'+B.roundNum(e.values.Average,2)+"</div></div>",l+='<div class="stat">'+(s>=0?"Premium":"Discount")+': <div class="value">'+s+"</div></div>",l+="<p>"+e.tooltip+"</p>",P.tooltip.html(l).style("left",function(){return r-390-.4*a-20+"px"}).style("top",function(){var e=t(this).outerHeight();return o-.15*e+"px"}),P.tooltip.classed("right",!0),window.clearTimeout(P.column_hover_timer),$||(P.column_hover_timer=window.setTimeout(function(){},1e3))}}).on("mouseout",function(t){window.clearTimeout(P.column_hover_timer),P.tooltip.style("display","none"),d3.select(this).attr("stroke-opacity",.25)})},update:function(t){P.id=t,P.item1.attr("fill",function(t,e){return e==P.id?"#bfd916":"#dfdfdf"}).attr("height",function(t){return P.intro_played[P.id]?Math.abs(P.y1(t.values.Current)-P.y1(0)):0}).attr("y",function(t){return P.intro_played[P.id]&&t.values.Current>0?P.y1(t.values.Current):P.y1(0)}),P.item2.attr("fill",function(t,e){return e==P.id?"#bfd916":"#dfdfdf"}).attr("height",function(t){return P.intro_played[P.id]?Math.abs(P.y2(t.values.Current)-P.y2(0)):0}).attr("y",function(t){return P.intro_played[P.id]&&t.values.Current>0?P.y2(t.values.Current):P.y2(0)}),P.pattern1.attr("y",function(t){return P.intro_played[P.id]?t.values.Current>t.values.Average?P.y1(t.values.Current):P.y1(t.values.Average):t.values.Current>t.values.Average?P.y1(t.values.Average):P.y1(t.values.Current)}).attr("height",function(t){return P.intro_played[P.id]?Math.abs(P.y1(t.values.Current)-P.y1(t.values.Average)):0}),P.pattern2.attr("y",function(t){return P.intro_played[P.id]?t.values.Current>t.values.Average?P.y2(t.values.Current):P.y2(t.values.Average):t.values.Current>t.values.Average?P.y2(t.values.Average):P.y2(t.values.Current)}).attr("height",function(t){return P.intro_played[P.id]?Math.abs(P.y2(t.values.Current)-P.y2(t.values.Average)):0}),P.bar1.attr("stroke-opacity",function(){return P.intro_played[P.id]?.25:0}),P.bar2.attr("stroke-opacity",function(){return P.intro_played[P.id]?.25:0})},resize:function(){P.width=q.$column_top.width()-P.margin.left-P.margin.right,P.x1=d3.scale.ordinal().rangeBands([0,P.width],0),P.x2=d3.scale.ordinal().rangeBands([0,P.width],0),P.xAxis1.scale(P.x1),P.xAxis2.scale(P.x2);var t=T.m_view?"left":"right";P.yAxis2.scale(P.y2).orient(t),P.x1.domain(P.group.equity.map(function(t){return t.name})),P.x2.domain(P.group.fixed_income.map(function(t){return t.name})),P.y1.domain([d3.min(P.group.equity,function(t){return 0}),d3.max(P.group.equity,function(t){return t.values.Current+.035})]),P.y2.domain([d3.min(P.group.fixed_income,function(t){return 0}),d3.max(P.group.fixed_income,function(t){return t.values.Current+.035})]),P.svg1.select("g.x.axis").attr("transform","translate(0, "+(P.height-.5)+")").call(P.xAxis1).selectAll("text").attr("transform","translate(0, 20)").call(P.wrapper,P.x1.rangeBand()),P.svg2.select("g.x.axis").attr("transform","translate(0, "+(P.height-.5)+")").call(P.xAxis2).selectAll("text").attr("transform","translate(0, 20)").call(P.wrapper,P.x2.rangeBand()),P.svg1.select("g.y.axis").call(P.yAxis1),P.svg2.select("g.y.axis").attr("transform",function(){if(!T.m_view)return"translate("+(P.width-0)+", 0)"}).call(P.yAxis2).selectAll("text").attr("transform",function(){return T.m_view?"translate(-10, 0)":"translate(10, 0)"}),P.line1=d3.svg.line().interpolate("basis").x(function(t){return P.x1(t.item)}),P.line2=d3.svg.line().interpolate("basis").x(function(t){return P.x2(t.item)});for(var e=0;e<P.group.equity.length-1;e++)P.svg1.select("line.divider-line"+e).attr({x1:P.width*(.3333*(e+1)),x2:P.width*(.3333*(e+1)),y1:0,y2:P.height}),P.svg2.select("line.divider-line"+e).attr({x1:P.width*(.3333*(e+1)),x2:P.width*(.3333*(e+1)),y1:0,y2:P.height});P.svg1.select("line.controlled-xAxis").attr({x1:0,x2:P.width,y1:P.y1(0),y2:P.y1(0)}),P.svg2.select("line.controlled-xAxis").attr({x1:0,x2:P.width,y1:P.y2(0),y2:P.y2(0)}),P.svg2.select("text.axis-label").attr("transform",function(){return T.m_view?"translate("+-1*P.margin.left*.75+", "+(.5*P.height+5)+") rotate(-90)":"translate("+(P.width+.75*P.margin.left+10)+", "+(.5*P.height+5)+") rotate(-90)"}),P.item1.attr("x",function(t){return P.x1(t.name)+.3*P.x1.rangeBand()}).attr("width",.4*P.x1.rangeBand()).attr("height",function(t){return P.intro_played[P.id]?Math.abs(P.y1(t.values.Current)-P.y1(0)):0}).attr("y",function(t){return P.intro_played[P.id]&&t.values.Current>0?P.y1(t.values.Current):P.y1(0)}),P.item2.attr("x",function(t){return P.x2(t.name)+.3*P.x2.rangeBand()}).attr("width",.4*P.x2.rangeBand()).attr("height",function(t){return P.intro_played[P.id]?Math.abs(P.y2(t.values.Current)-P.y2(0)):0}).attr("y",function(t){return P.intro_played[P.id]&&t.values.Current>0?P.y2(t.values.Current):P.y2(0)}),P.pattern1.attr("x",function(t){return P.x1(t.name)+.3*P.x1.rangeBand()}).attr("y",function(t){return P.intro_played[P.id]?t.values.Current>t.values.Average?P.y1(t.values.Current):P.y1(t.values.Average):t.values.Current>t.values.Average?P.y1(t.values.Average):P.y1(t.values.Current)}).attr("width",.4*P.x1.rangeBand()).attr("height",function(t){return P.intro_played[P.id]?Math.abs(P.y1(t.values.Current)-P.y1(t.values.Average)):0}),P.pattern2.attr("x",function(t){return P.x2(t.name)+.3*P.x2.rangeBand()}).attr("y",function(t){return P.intro_played[P.id]?t.values.Current>t.values.Average?P.y2(t.values.Current):P.y2(t.values.Average):t.values.Current>t.values.Average?P.y2(t.values.Average):P.y2(t.values.Current)}).attr("width",.4*P.x2.rangeBand()).attr("height",function(t){return P.intro_played[P.id]?Math.abs(P.y2(t.values.Current)-P.y2(t.values.Average)):0}),P.bar1.attr("x",function(t){return P.x1(t.name)+.3*P.x1.rangeBand()}).attr("width",.4*P.x1.rangeBand()),P.bar2.attr("x",function(t){return P.x2(t.name)+.3*P.x2.rangeBand()}).attr("width",.4*P.x2.rangeBand()),P.point1.attr("transform",function(t,e){return"translate("+(.3333*P.width*.5+P.width*(.3333*e))+", "+P.y1(t.values.Average)+")"}),P.point2.attr("transform",function(t,e){return"translate("+(.3333*P.width*.5+P.width*(.3333*e))+", "+P.y2(t.values.Average)+")"}),P.svg1.attr("width",P.width+P.margin.left+P.margin.right+"px"),P.svg2.attr("width",P.width+P.margin.left+P.margin.right+"px").attr("transform",function(){return T.m_view?"translate("+P.margin.left+","+P.margin.top+")":"translate("+P.margin.right+","+P.margin.top+")"}),d3.selectAll("svg.column-chart").attr("width",P.width+P.margin.left+P.margin.right+"px")},draw:function(){P.intro_played[P.id]||(P.intro_played[P.id]=!0,w.isTouch?(P.item1.attr("height",function(t){return Math.abs(P.y1(t.values.Current)-P.y1(0))}).attr("y",function(t){return t.values.Current>0?P.y1(t.values.Current):P.y1(0)}),P.item2.attr("height",function(t){return Math.abs(P.y2(t.values.Current)-P.y2(0))}).attr("y",function(t){return t.values.Current>0?P.y2(t.values.Current):P.y2(0)}),P.pattern1.attr("height",function(t){return Math.abs(P.y1(t.values.Current)-P.y1(t.values.Average))}).attr("y",function(t){return t.values.Current>t.values.Average?P.y1(t.values.Current):P.y1(t.values.Average)}),P.pattern2.attr("height",function(t){return Math.abs(P.y2(t.values.Current)-P.y2(t.values.Average))}).attr("y",function(t){return t.values.Current>t.values.Average?P.y2(t.values.Current):P.y2(t.values.Average)}),P.bar1.attr("stroke-opacity",.25),P.bar2.attr("stroke-opacity",.25)):(P.item1.attr("y",P.y1(0)).attr("height",0).transition().duration(500).delay(function(t,e){return 250*e}).ease(d3.easeSinInOut).attr("height",function(t){return Math.abs(P.y1(t.values.Current)-P.y1(0))}).attr("y",function(t){return t.values.Current>0?P.y1(t.values.Current):P.y1(0)}),P.item2.attr("y",P.y2(0)).attr("height",0).transition().duration(500).delay(function(t,e){return 250*e}).ease(d3.easeSinInOut).attr("height",function(t){return Math.abs(P.y2(t.values.Current)-P.y2(0))}).attr("y",function(t){return t.values.Current>0?P.y2(t.values.Current):P.y2(0)}),P.pattern1.attr("y",function(t){return t.values.Current>t.values.Average?P.y1(t.values.Average):P.y1(t.values.Current)}).attr("height",0).transition().duration(250).delay(function(t,e){return 250*e+250}).ease(d3.easeSinInOut).attr("height",function(t){return Math.abs(P.y1(t.values.Current)-P.y1(t.values.Average))}).attr("y",function(t){return t.values.Current>t.values.Average?P.y1(t.values.Current):P.y1(t.values.Average)}),P.pattern2.attr("y",function(t){return t.values.Current>t.values.Average?P.y2(t.values.Average):P.y2(t.values.Current)}).attr("height",0).transition().duration(250).delay(function(t,e){return 250*e+250}).ease(d3.easeQuadInOut).attr("height",function(t){return Math.abs(P.y2(t.values.Current)-P.y2(t.values.Average))}).attr("y",function(t){return t.values.Current>t.values.Average?P.y2(t.values.Current):P.y2(t.values.Average)}),P.bar1.attr("stroke-opacity",0).transition().duration(250).delay(function(t,e){return 250*e+500}).ease(d3.easeQuadInOut).attr("stroke-opacity",.25),P.bar2.attr("stroke-opacity",0).transition().duration(250).delay(function(t,e){return 250*e+500}).ease(d3.easeQuadInOut).attr("stroke-opacity",.25)))},wrapper:function(t,e){t.each(function(){for(var t,n=d3.select(this),a=n.text().split(/\s+/).reverse(),i=[],r=0,o=n.attr("y"),s=parseFloat(n.attr("dy")),l=n.text(null).append("tspan").attr("x",0).attr("y",o).attr("dy",s+"em");t=a.pop();)i.push(t),l.text(i.join(" ")),l.node().getComputedTextLength()>e&&(i.pop(),l.text(i.join(" ")),i=[t],l=n.append("tspan").attr("x",0).attr("y",o).attr("dy",1.2*++r+s+"em").text(t))})}},D={$cont:null,$table:null,$row_btn:null,$detail_btn:null,$fund_btn:null,$detail_all:null,$detail_close:null,detail_box_elm:null,detail_content_elm:null,table_data:[["left","left","right"],["left","left","left"]],init:function(){this.$cont=s.find("section#asset-class"),this.$table=this.$cont.find(".table"),this.$instructions=this.$cont.find(".bb-tool-tip"),this.$row_btn=this.$table.find(".asset-row"),this.$detail_btn=this.$table.find(".asset-row .asset-column a.asset-detail"),this.$fund_btn=this.$table.find(".asset-row .asset-column a.fund"),this.$detail_all=this.$table.find(".detail-row"),this.$detail_close=this.$table.find(".detail-row a.close-btn"),this.$detail_all.css("height",0),this.$row_btn.on("click",this.detail_box_open.bind(this)),this.$detail_btn.on("click",this.detail_box_open.bind(this)),this.$detail_close.on("click",function(e){e.preventDefault(),e.stopPropagation();t(e.currentTarget);D.detail_box_close(),D.$cont.removeClass("detail-opened"),setTimeout(function(){k.set_section_pos()},525)}),this.$fund_btn.on("mouseover",function(e){e.preventDefault(),e.stopPropagation();var n=t(e.currentTarget),a=n.prev();a.hasClass("off")||a.addClass("off")}),this.$fund_btn.on("mouseout",function(t){t.preventDefault(),t.stopPropagation(),D.$detail_btn.removeClass("off")}),this.$fund_btn.on("click",function(e){e.preventDefault(),e.stopPropagation();var n=t(e.currentTarget),a=g+v+n.attr("href").substring(2);window.open(a,"_top")})},detail_box_open:function(e){e.preventDefault(),e.stopPropagation();var n,a,i,r=t(e.currentTarget);if(r.hasClass("asset-detail")?(n=r.parent().parent().parent().find(".detail-row"),a=r.parent().parent()):(n=r.parent().find(".detail-row"),a=r),i=a.parent().parent().parent().index()-2,D.$table.eq(i).hasClass("on")||D.anim_in_table(i),n.hasClass("on"))D.detail_box_close(),D.$cont.removeClass("detail-opened"),setTimeout(function(){k.set_section_pos()},525);else{D.detail_box_close(),D.$cont.hasClass("detail-opened")?(setTimeout(function(){k.set_section_pos()},1025),setTimeout(function(){k.anchor_anim(null,n.offset().top-140)},760)):(setTimeout(function(){D.$cont.addClass("detail-opened")},250),setTimeout(function(){k.set_section_pos()},525),setTimeout(function(){k.anchor_anim(null,n.offset().top-140)},10)),n.removeAttr("style");var o=n.outerHeight();D.detail_box_elm=n,D.detail_content_elm=n.find(".detail-content"),n.css("height",0),n.addClass("on"),a.addClass("on"),setTimeout(function(){n.css("height",o+"px")},10)}this.$instructions.css("display","none")},detail_box_close:function(){D.$detail_all.css("height",0),D.$detail_all.removeClass("on"),D.$row_btn.removeClass("on"),D.detail_box_elm=null,D.detail_content_elm=null},scroll_checker:function(t){t>this.$table.eq(0).offset().top+.75*this.$table.eq(0).height()+50-T.height&&D.anim_in_table(0),t>this.$table.eq(1).offset().top+.75*this.$table.eq(1).height()+50-T.height&&D.anim_in_table(1)},anim_in_table:function(e){if(D.$table&&!D.$table.eq(e).hasClass("on")){D.$table.eq(e).addClass("on");var n=0;this.$table.eq(e).find("div.asset-row").each(function(a){var i=t(this);n=75*a,D.add_class(i,D.table_data[e][a],n)})}},add_class:function(t,e,n){setTimeout(function(){t.hasClass(e)||t.addClass(e)},n)}},B={days_of_week:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],months_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],query_components:function(t,e){return e.filter(function(e){return e.components.filter(function(e){return e.name==t}).length>0}).map(function(t){return t.content})},hasHTML:function(e){return/<p\b[^>]*>/gi.test(e)&&!!t(e)[0]},dateFromUTCString:function(t){return t=t.split(/[\D]/gi),new Date(Date.UTC(t[0],--t[1],t[2],t[3],t[4],t[5],t[6]||0))},dSort:function(t){var e=1;return"-"===t[0]&&(e=-1,t=t.substr(1)),function(n,a){return(n[t]<a[t]?-1:n[t]>a[t]?1:0)*e}},roundNum:function(t,e){var n=e?Math.pow(10,e):100,a=Math.round((Number(t)+1e-5)*n)/n,i=(""+a).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e>(i?Math.max(0,(i[1]?i[1].length:0)-(i[2]?+i[2]:0)):0)?a.toFixed(e):a},randomNum:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},dateFormat:function(t){var e=(new Date(t)+"").split(" "),n=B.months_short.indexOf(e[1]);return e[1]=B.months[n]+",",[e[1],e[3]].join(" ")},shuffleArray:function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),a=t[e];t[e]=t[n],t[n]=a}return t},extractDomain:function(t){var e;return e=t.indexOf("://")>-1?t.split("/")[2]:t.split("/")[0],e=e.split(":")[0]},get_query_value:function(t,e){e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)"),a=n.exec(e);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null},escapeHTML:function(t){var e=document.createElement("a");return e.href=t,e.protocol+"//"+e.host+e.pathname+e.search+e.hash}};return t.easing.jswing=t.easing.swing,t.extend(t.easing,{def:"easeOutQuad",swing:function(e,n,a,i,r){return t.easing[t.easing.def](e,n,a,i,r)},easeInQuad:function(t,e,n,a,i){return a*(e/=i)*e+n},easeOutQuad:function(t,e,n,a,i){return-a*(e/=i)*(e-2)+n},easeInOutQuad:function(t,e,n,a,i){return(e/=i/2)<1?a/2*e*e+n:-a/2*(--e*(e-2)-1)+n},easeInCubic:function(t,e,n,a,i){return a*(e/=i)*e*e+n},easeOutCubic:function(t,e,n,a,i){return a*((e=e/i-1)*e*e+1)+n},easeInOutCubic:function(t,e,n,a,i){return(e/=i/2)<1?a/2*e*e*e+n:a/2*((e-=2)*e*e+2)+n},easeInSine:function(t,e,n,a,i){return-a*Math.cos(e/i*(Math.PI/2))+a+n},easeOutSine:function(t,e,n,a,i){return a*Math.sin(e/i*(Math.PI/2))+n},easeInOutSine:function(t,e,n,a,i){return-a/2*(Math.cos(Math.PI*e/i)-1)+n},easeInExpo:function(t,e,n,a,i){return 0==e?n:a*Math.pow(2,10*(e/i-1))+n},easeOutExpo:function(t,e,n,a,i){return e==i?n+a:a*(1-Math.pow(2,-10*e/i))+n},easeInOutExpo:function(t,e,n,a,i){return 0==e?n:e==i?n+a:(e/=i/2)<1?a/2*Math.pow(2,10*(e-1))+n:a/2*(2-Math.pow(2,-10*--e))+n}}),{init:x}}(jQuery),OFI_2018_OUTLOOK.namespace("controller"),OFI_2018_OUTLOOK.controller=function(){return{init:function(){document.documentElement.setAttribute("data-useragent",navigator.userAgent),OFI_2018_OUTLOOK.app.init()}}}(),$(document).ready(function(){OFI_2018_OUTLOOK.controller.init()});
//# sourceMappingURL=../maps/app.min.js.map
